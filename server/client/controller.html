<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamepad Client</title>
    <script src="./jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body>
    <div id="shoulder-buttons" class="p-4 flex justify-between items-center">
      <button class="button p-2 px-8 text-xl font-medium bg-black text-gray-100 rounded-xl" id="q">L</button>
      <button class="button p-2 px-6 text-xl font-medium bg-black text-gray-100 rounded-xl" id="e">Select</button>
      <button class="button p-2 px-8 text-xl font-medium bg-black text-gray-100 rounded-xl" id="u">Start</button>
      <button class="button p-2 px-8 text-xl font-medium bg-black text-gray-100 rounded-xl" id="o">R</button>
    </div>

    <div class="my-4 p-4 flex justify-between items-center">
      <div id="d-pad" class="size-48 grid grid-rows-3 grid-cols-3">
        <div></div>
        <button class="button size-16 bg-black rounded-t-xl" id="w">Up</button>
        <div></div>
        <button class="button size-16 bg-black rounded-l-xl" id="a">Left</button>
        <div class="size-16 bg-black"></div>
        <button class="button size-16 bg-black rounded-r-xl" id="d">Right</button>
        <div></div>
        <button class="button size-16 bg-black rounded-b-xl" id="s">Down</button>
        <div></div>
      </div>

      <div id="face-buttons" class="size-48 grid grid-rows-3 grid-cols-3">
        <div></div>
        <button class="button size-16 text-2xl font-bold bg-black text-yellow-400 rounded-full" id="i">Y</button>
        <div></div>
        <button class="button size-16 text-2xl font-bold bg-black text-blue-400 rounded-full" id="j">X</button>
        <div></div>
        <button class="button size-16 text-2xl font-bold bg-black text-red-400 rounded-full" id="l">B</button>
        <div></div>
        <button class="button size-16 text-2xl font-bold bg-black text-green-400 rounded-full" id="k">A</button>
        <div></div>
      </div>
    </div>

    <script>
    // $(".button").on("click", async (e) => {
    //   const button_id = e.target.id
    //
    //   // const url = `http://localhost:8000/api/gamepad/${button_id}`
    //   const url = `http://192.168.0.107:8000/api/gamepad/${button_id}`
    //
    //   const response = await fetch(url, {
    //     method: "POST"
    //   })
    //   console.log(response)
    // })

    const wsURI = "ws://192.168.0.107:8000/ws/gamepad"
    const socket = new WebSocket(wsURI)

    socket.addEventListener("open", () => {
      console.log("ws connected")

      $(".button").on("click", async (e) => {
        const button_id = e.target.id

        socket.send(button_id)
      })
    })
    </script>
  </body>
</html>
